"""
Тестируемое приложение "Калькулятор с багами"
Студент тестирует это приложение методами черного ящика
"""
import sys


def buggy_calculator():
    """
    Калькулятор с намеренными багами для тестирования
    Баги:
    1. Деление на 0 вызывает падение (необработанное исключение)
    2. Умножение 10 на 10 возвращает 1010 вместо 100
    3. Вычитание из меньшего числа большего дает 0
    4. Квадратный корень из отрицательного числа вызывает RuntimeError
    5. При вводе букв вместо цифр - бесконечный цикл
    """
    print("=" * 50)
    print("БАГАТЫЙ КАЛЬКУЛЯТОР (с багами)")
    print("=" * 50)
    print("Операции: +, -, *, /, sqrt, power")
    print("Для выхода введите 'exit'")
    print("=" * 50)

    while True:
        try:
            # БАГ 5: Нет проверки на нечисловой ввод в первой переменной
            num1_input = input("\nВведите первое число: ")
            if num1_input.lower() == 'exit':
                break

            # БАГ 5: Если ввести букву - будет ValueError, но мы его не обрабатываем
            num1 = float(num1_input)

            op = input("Введите операцию (+, -, *, /, sqrt, power): ")

            if op == 'sqrt':
                # БАГ 4: Квадратный корень из отрицательного числа
                if num1 < 0:
                    # Намеренная ошибка
                    raise RuntimeError("Мнимые числа не поддерживаются!")
                result = num1 ** 0.5
            else:
                num2 = float(input("Введите второе число: "))

                if op == '+':
                    result = num1 + num2
                elif op == '-':
                    # БАГ 3: Вычитание из меньшего числа большего
                    if num1 < num2:
                        result = 0  # Намеренная ошибка!
                    else:
                        result = num1 - num2
                elif op == '*':
                    # БАГ 2: Умножение 10 на 10
                    if num1 == 10 and num2 == 10:
                        result = 1010  # Намеренная ошибка!
                    else:
                        result = num1 * num2
                elif op == '/':
                    # БАГ 1: Деление на 0
                    result = num1 / num2  # Упадет при num2 = 0
                elif op == 'power':
                    result = num1 ** num2
                else:
                    print("Неизвестная операция!")
                    continue

            print(f"Результат: {result}")

        except ZeroDivisionError:
            print("ОШИБКА: Деление на ноль!")
            # БАГ: Неправильное сообщение об ошибке
            print("Системная ошибка: доступ запрещен")
        except ValueError as e:
            print(f"ОШИБКА ввода: {e}")
            # БАГ: Нет выхода из цикла при ошибке
            print("Попробуйте еще раз...")
        except RuntimeError as e:
            print(f"ОШИБКА: {e}")
            # БАГ: Несоответствующее сообщение
            print("Фатальная ошибка системы!")


if __name__ == "__main__":
    buggy_calculator()